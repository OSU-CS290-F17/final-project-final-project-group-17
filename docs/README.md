# Project documents should go in this folder.

## Database Documents

* tasks_db.dia - Dia database diagram
* tasks_db.png - PNG output of the Dia diagram
* tasks_db.sql - SQL Database schema for tasks database

### Task Item Descriptions

Tasks contain eight data elements, some will be automatically generated and others will be supplied by the user.


| Field Name | Data Type | Generated By | Description |
| --- | --- | --- | --- |
| task_id        |  int(11) AUTO_INCREMENT    | Automatic  | Unique field for tasks, this is hidden from the user but used to key all CREATE/READ/UPDATE/DELETE (CRUD) operations. |
| task_group     |  enum('A','B','C','D','E') | User Input | Task group that this task is a part of. Only possible values are ABCDE |
| task_title     |  varchar(255)              | User Input | The short description of this task: <= 255 characters |
| task_details   |  text                      | User Input | Long description of this task: <= 65535 characters |
| task_priority  |  int(11)                   | User Input | This is the sort order, sorted ascending order, so lower number will be first |
| date_added     |  datetime                  | Automatic  | Format: 'YYYY-MM-DD HH:MM:SS' |
| date_due       |  datetime                  | User Input | Format: 'YYYY-MM-DD HH:MM:SS' |
| date_done      |  datetime                  | Automatic  | Format: 'YYYY-MM-DD HH:MM:SS' |


### Database HTTP API


#### GET /ajax/loadtasks

Fetch all tasks that exist in the database.

__Return Status:__
* 200 - Query was processed, Response: JSON encoded array of Task objects.
* 500 - Error loading (unspecified). Response: JSON encoded empty array


#### GET /ajax/loadtasks/:groupId

Fetch all tasks that exist in the database that are in a particular group identified by groupId. Valid groups are: A B C D E

__Return Status:__
* 200 - Query was processed, Response: JSON serialized array of Task objects.
* 500 - Error loading (unspecified). Response: JSON encoded empty array


#### GET /ajax/deltask/:taskId

Delete the task specified by :taskId

__Return Status:__
* 200 - Query was processed, Response: blank
* 500 - Error loading (unspecified). Response: blank


#### POST /ajax/savetask

Save or update a task. POST should contain a serialized JSON object of a single Task object.

__Return Status:__
* 200 - Task was saved, Response: JSON serialized object { task_id: new_task_id }
* 500 - Error saving (unspecified). Response: error message



### Database ADT

Database ADT accept and return a Task object or a collection of Task objects. This Task object will be defined in javascript and instantiated for task in the visible page.

The Task object will have data elements for each of the fields above.

The following database functions will be available (subject to change)

```
/* Load all Task objects from the database sorted by task_group then task_priority
 * @TODO Evaluate if this is actually needed
 *
 * Returns:
 *    array of Task objects
 */
loadAllTasks();

/* Load all Task objects in the specified group from the database sorted by task_priority
 *
 * Params:
 *   group - one of the fixed group values: 'A' 'B' 'C' 'D' 'E'
 *
 * Returns:
 *    array of Task objects
 */
loadAllTasksByGroup(group);

/* Save a task object to the database. If the object does not contain a task_id
 * then a new item will be saved to the database. Otherwise the task with this
 * id will be updated.
 *
 * An object will be returned with a status of the save operation as well as
 * the task_id (the new one if it was inserted).
 *
 * Params:
 *   task - a filled Task object
 *
 * Returns:
 *    object { status: true || false, task_id: task_id }
 */
saveTask(task);


/* Delete a task object from the database.
 *
 * A boolean will be returned with the result of the delete operation.
 *
 * Params:
 *   task_id - task_id of task to delete
 *
 * Returns:
 *    boolean true or false
 */
deleteTask(task);
```
